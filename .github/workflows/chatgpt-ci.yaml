name: gemini ci

on:
  push:
    branches: [ master ]

jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1

      - name: Execute ssh command via using private key
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.REMOTE_HOST }}
          username: ${{ secrets.REMOTE_USER }}
          key: ${{ secrets.CICD_SSH_KEY }}
          port: ${{ secrets.PORT }}
          script: |
            pwd
            cd ${{ secrets.REMOTE_TARGET }}
            git pull origin master

# Notify on fail
      - name: Notify on failure
        if: failure()
        run: |
           
            curl -X POST -H "Content-Type: application/json" -d '{"text":"❌❌❌GitHub Action Deployment failed❌❌❌ for branch ${{ github.ref }} in repository ${{ github.repository }}"}' "https://cliq.zoho.com/company/654406765/api/v2/channelsbyname/testingchannel/message?zapikey=${{ secrets.CLIQ_API_KEY }}"
      # Example: Notify on success
      - name: Notify on success
        if: success()
        run: |
            curl -X POST -H "Content-Type: application/json" -d '{"text":"✅✅✅GitHub Action Deployemnt passed for branch ${{ github.ref }} in repository ${{ github.repository }}"}' "https://cliq.zoho.com/company/654406765/api/v2/channelsbyname/aocinternal/message?zapikey=${{ secrets.CLIQ_API_KEY }}"
